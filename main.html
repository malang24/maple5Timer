<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ5ë¶„ ê²½í—˜ì¹˜</title>
    <style>
        @font-face {
            font-family: 'MaplestoryOTFBold';
            src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_20-04@2.1/MaplestoryOTFBold.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: 'MabinogiClassicR';
            src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2207-01@1.0/MabinogiClassicR.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }

        body {
            font-family: MabinogiClassicR;
            text-align: center;
            padding: 50px;
            background-color: black;
            color: white;
        }
        .timer {
            color: yellow;
            font-size: 60px;
        }
        .buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        button {
            font-family: MabinogiClassicR;
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            background-color: #444;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:hover {
            background-color: #555;
        }
        button:disabled {
            background-color: #333;
        }
        .input-container {
            margin-top: 30px;
        }
        .input-container input {
            padding: 10px;
            font-size: 18px;
            margin: 10px;
            background-color: #333;
            color: white;
            border: none;
            border-radius: 5px;
            width: 200px;
        }
        .input-container label {
            font-size: 20px;
        }
        .calculation-result {
            margin-top: 20px;
            margin-bottom: 20px;
            font-size: 22px;
            font-weight: bold;
        }
        .input-with-korean {
            font-size: 10px;
        }
        .alertCheckBox{
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    
    
    ğŸ <div class="timer" id="timer">05:00</div>

    <div>
        <label for="timerInput">íƒ€ì´ë¨¸ ì‹œê°„ (ë¶„): </label>
        <input type="number" id="timerInput" value="5" min="0"  style="margin-bottom: 10px;" oninput="updateTimerFromInput()" />
        ë¶„
    </div>

    <div class="alertCheckBox" >
        <label>
            <input type="checkbox" id="soundCheckbox"> ì•Œë¦¼ ì†Œë¦¬ ë“£ê¸°
        </label>
    </div>
    
    <div class="buttons">
        <button id="startButton" style="background-color: green;">ì‹œì‘</button>
        <button id="pauseButton" style="background-color: red;" disabled>ì¼ì‹œ ì •ì§€</button>
        <button id="resetButton" style="background-color: yellowgreen" >ë¦¬ì…‹</button>
    </div>

    <!-- ê²½í—˜ì¹˜ ë° ë©”ì†Œ ì…ë ¥ í•„ë“œ -->
    <div class="input-container">
        <div>
            <label for="expInput">ê²½í—˜ì¹˜:</label>
            <input type="text" id="expInput" placeholder="ê²½í—˜ì¹˜ ì…ë ¥" oninput="formatNumber(this); handleCalculation()">
            exp
        </div>
        <div>
            <label for="mesoInput">ë©”ì†Œ:</label>
            <input type="text" id="mesoInput" placeholder="ë©”ì†Œ ì…ë ¥" oninput="formatNumber(this); handleCalculation()">
            ì›
        </div>
        <div id="calculationResult" class="calculation-result"></div>

        <div>
            <label for="newExpInput">ìƒˆë¡œìš´ ê²½í—˜ì¹˜:</label>
            <input type="text" id="newExpInput" placeholder="ìƒˆë¡œìš´ ê²½í—˜ì¹˜ ì…ë ¥" oninput="formatNumber(this); handleCalculation()">
            exp
        </div>
        <div>
            <label for="newMesoInput">ìƒˆë¡œìš´ ë©”ì†Œ:</label>
            <input type="text" id="newMesoInput" placeholder="ìƒˆë¡œìš´ ë©”ì†Œ ì…ë ¥" oninput="formatNumber(this); handleCalculation()">
            ì›
        </div>        

        <div> @ì œì‘ ë©”ì´í”Œëœë“œ : ë¿Œë¹° </div>
        <a href="https://hits.seeyoufarm.com"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fmalang24.github.io%2Fmaple5Timer%2Fmain.html&count_bg=%23EFA0BA&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=false"/></a>
    </div>

    <script>
        let timer;
        let seconds = 300; // 5ë¶„ (300ì´ˆ)
        let isRunning = false;

        const timerElement = document.getElementById('timer');
        const startButton = document.getElementById('startButton');
        const pauseButton = document.getElementById('pauseButton');
        const resetButton = document.getElementById('resetButton');
        
        let createdNewFields = false; // ìƒˆë¡œìš´ ì…ë ¥ í•„ë“œ ìƒì„± ì—¬ë¶€ í™•ì¸

        // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateTimerDisplay() {
            let minutes = Math.floor(seconds / 60);
            let remainingSeconds = seconds % 60;
            timerElement.textContent = `${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`;
        }

        // íƒ€ì´ë¨¸ ì‹œì‘
        function startTimer() {
            timer = setInterval(function() {
                if (seconds > 0) {
                    seconds--;
                    updateTimerDisplay();
                } 
                else {
                    clearInterval(timer);
                    isRunning = false;
                    startButton.disabled = false;
                    pauseButton.disabled = true;
                    resetButton.disabled = false;
                 
                    // ì²´í¬ë°•ìŠ¤ ìƒíƒœ í™•ì¸: ì•Œë¦¼ìŒ ì†Œë¦¬ë¥¼ ì¼œë†“ì•˜ì„ ê²½ìš°ì—ë§Œ ì†Œë¦¬ ì¬ìƒ
                    const soundCheckbox = document.getElementById('soundCheckbox');
                    if (soundCheckbox.checked) {
                        const alarmSound = new Audio('/maple5Timer/melody.mp3'); // ì•ŒëŒ íŒŒì¼ ê²½ë¡œ
                        alarmSound.play();  // ì•ŒëŒ ì†Œë¦¬ ì¬ìƒ
                    }
            
                  // í™”ë©´ì— ì•Œë¦¼ ë©”ì‹œì§€ í‘œì‹œ
                    const alertMessage = document.createElement('div');
                    alertMessage.innerText = "íƒ€ì´ë¨¸ê°€ ëë‚¬ìŠµë‹ˆë‹¤! (í´ë¦­ì‹œ ì‚¬ë¼ì§‘ë‹ˆë‹¤.)";
                    alertMessage.style.position = "absolute";
                    alertMessage.style.top = "42%";
                    alertMessage.style.left = "50%";
                    alertMessage.style.transform = "translate(-50%, -50%)";
                    alertMessage.style.backgroundColor = "#ef00ff";
                    alertMessage.style.color = "white";
                    alertMessage.style.padding = "20px";
                    alertMessage.style.fontSize = "20px";
                    alertMessage.style.borderRadius = "10px";
                    alertMessage.style.cursor = "pointer"; // í´ë¦­ ì»¤ì„œë¡œ ë³€ê²½
                    document.body.appendChild(alertMessage);

                    // í´ë¦­ ì‹œ ì•Œë¦¼ ë©”ì‹œì§€ ì œê±°
                    alertMessage.addEventListener('click', function() {
                        alertMessage.remove();
                    });
                }
            }, 1000);

            isRunning = true;
            startButton.disabled = true;
            pauseButton.disabled = false;
            resetButton.disabled = false;
        }


        function updateTimerFromInput() {
            let timerInput = document.getElementById('timerInput');
            let inputValue = timerInput.value;

            // ìˆ«ìê°€ ì•„ë‹Œ ë¬¸ìê°€ ë“¤ì–´ê°”ì„ ê²½ìš° ì œê±°
            inputValue = inputValue.replace(/[^\d]/g, '');

            // 3ìë¦¬ë¡œ ì œí•œ
            if (inputValue.length > 3) {
                inputValue = inputValue.slice(0, 3);
            }

            timerInput.value = inputValue;

            // ì´ˆë¡œ ë³€í™˜í•˜ì—¬ íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸
            let inputMinutes = parseInt(inputValue) || 0;
            seconds = inputMinutes * 60;
            updateTimerDisplay();
        }


        // íƒ€ì´ë¨¸ ì¼ì‹œ ì •ì§€
        function pauseTimer() {
            clearInterval(timer);
            isRunning = false;
            startButton.disabled = false;
            pauseButton.disabled = true;
        }

        // íƒ€ì´ë¨¸ ë¦¬ì…‹
         function resetTimer() {
            // íƒ€ì´ë¨¸ê°€ ì‹¤í–‰ ì¤‘ì¼ ë•Œ ë¦¬ì…‹ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì•Œë¦¼ì°½ì„ ë„ì›€
            if (isRunning) {
                alert("íƒ€ì´ë¨¸ê°€ ì§„í–‰ì¤‘ì…ë‹ˆë‹¤. ì¼ì‹œ ì •ì§€ë¥¼ ëˆŒëŸ¬ì•¼ ë¦¬ì…‹ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
                return; // ë¦¬ì…‹ ë™ì‘ì„ ì¤‘ì§€
            }

            // íƒ€ì´ë¨¸ê°€ ì‹œì‘ë˜ì§€ ì•Šì•˜ê±°ë‚˜, ì¼ì‹œ ì •ì§€ ìƒíƒœì¼ ë•Œ ë¦¬ì…‹ ì²˜ë¦¬
            seconds = 300;  // 5ë¶„(300ì´ˆ)ìœ¼ë¡œ ì„¤ì •
            updateTimerDisplay();  // í™”ë©´ì— ì—…ë°ì´íŠ¸

            // íƒ€ì´ë¨¸ ìƒíƒœ ì´ˆê¸°í™”
            clearInterval(timer);
            isRunning = false;

             // íƒ€ì´ë¨¸ inputë„ ì´ˆê¸°í™” (5ë¡œ ì„¤ì •)
            const timerInput = document.getElementById('timerInput');
            timerInput.value = 5;

            // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            startButton.disabled = false;
            pauseButton.disabled = true;
            //resetButton.disabled = true;
            resetButton.disabled = false;
        }

      
      
        // ì‹œì‘ ë²„íŠ¼ í´ë¦­ ì‹œ íƒ€ì´ë¨¸ ì‹œì‘
        startButton.addEventListener('click', function() {
            if (!isRunning) {
                startTimer();
            }
        });

        // ì¼ì‹œ ì •ì§€ ë²„íŠ¼ í´ë¦­ ì‹œ íƒ€ì´ë¨¸ ë©ˆì¶”ê¸°
        pauseButton.addEventListener('click', function() {
            if (isRunning) {
                pauseTimer();
            }
        });

        // ë¦¬ì…‹ ë²„íŠ¼ í´ë¦­ ì‹œ íƒ€ì´ë¨¸ ë¦¬ì…‹
        resetButton.addEventListener('click', resetTimer);

        // ì´ˆê¸° íƒ€ì´ë¨¸ ë””ìŠ¤í”Œë ˆì´ ì—…ë°ì´íŠ¸
        updateTimerDisplay();

        // ê³„ì‚° í•¨ìˆ˜
        function handleCalculation() {
            // ê¸°ì¡´ ê²½í—˜ì¹˜ì™€ ë©”ì†Œ ì…ë ¥ê°’
            const expInput = document.getElementById('expInput').value.replace(/[^\d]/g, ''); // ìˆ«ì ì™¸ì˜ ë¬¸ì ì œê±°
            const mesoInput = document.getElementById('mesoInput').value.replace(/[^\d]/g, ''); // ìˆ«ì ì™¸ì˜ ë¬¸ì ì œê±°

            // ìƒˆë¡œìš´ ê²½í—˜ì¹˜ì™€ ë©”ì†Œ ì…ë ¥ê°’
            const newExpInput = document.getElementById('newExpInput').value.replace(/[^\d]/g, ''); // ìˆ«ì ì™¸ì˜ ë¬¸ì ì œê±°
            const newMesoInput = document.getElementById('newMesoInput').value.replace(/[^\d]/g, ''); // ìˆ«ì ì™¸ì˜ ë¬¸ì ì œê±°

            // ê°’ì´ ë¹„ì–´ìˆìœ¼ë©´ ê³„ì‚°í•˜ì§€ ì•ŠìŒ
            let resultText = '';

            // ê²½í—˜ì¹˜ ì°¨ì´ ê³„ì‚° (ê²½í—˜ì¹˜ì™€ ìƒˆë¡œìš´ ê²½í—˜ì¹˜ê°€ ëª¨ë‘ ì…ë ¥ëœ ê²½ìš°)
            if (expInput !== '' && newExpInput !== '') {
                const expValue = parseInt(expInput);
                const newExpValue = parseInt(newExpInput);
                const expDifference = newExpValue - expValue;
                resultText += `<p><img src="/maple5Timer/exp.png" alt="ê²½í—˜ì¹˜ ì•„ì´ì½˜" style="width: 20px; height: 20px; margin-right: 8px;">ê²½í—˜ì¹˜ ì°¨ì´  : ${expDifference.toLocaleString()} exp</p>`;
            }

            // ë©”ì†Œ ì°¨ì´ ê³„ì‚° (ë©”ì†Œì™€ ìƒˆë¡œìš´ ë©”ì†Œê°€ ëª¨ë‘ ì…ë ¥ëœ ê²½ìš°)
            if (mesoInput !== '' && newMesoInput !== '') {
                const mesoValue = parseInt(mesoInput);
                const newMesoValue = parseInt(newMesoInput);
                const mesoDifference = newMesoValue - mesoValue;
                resultText += `<p><img src="/maple5Timer/meso.png" alt="ë©”ì†Œ ì•„ì´ì½˜" style="width: 20px; height: 20px; margin-right: 8px;">ë©”ì†Œ ì°¨ì´  : ${mesoDifference.toLocaleString()} ì›</p>`;
            }

            // ê²°ê³¼ê°€ ì—†ìœ¼ë©´ ê³µë°±ì„ ì¶œë ¥í•˜ì§€ ì•ŠìŒ
            document.getElementById('calculationResult').innerHTML = resultText;
        }

           // ìˆ«ì í˜•ì‹í™” í•¨ìˆ˜ (ì²œë‹¨ìœ„ êµ¬ë¶„ì ì¶”ê°€)
           function formatNumber(input) {
            let value = input.value.replace(/[^\d]/g, ''); // ìˆ«ì ì™¸ì˜ ë¬¸ì ì œê±°

            // ì²œë‹¨ìœ„ êµ¬ë¶„ì ì¶”ê°€
            value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            input.value = value;

        }


    </script>

</body>
</html>
